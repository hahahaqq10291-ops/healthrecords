{% extends "shared/base.html" %} {% block extra_css %}
<style>
  .audit-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }

  .audit-header {
    margin-bottom: 30px;
    border-bottom: 2px solid #a83e51;
    padding-bottom: 15px;
  }

  .audit-header h1 {
    margin: 0;
    color: #333;
  }

  .audit-header p {
    color: #666;
    margin-top: 5px;
  }

  .filters {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }

  .filters input,
  .filters select {
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
  }

  .logs-table {
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .logs-table table {
    width: 100%;
    border-collapse: collapse;
  }

  .logs-table th {
    background: #f8f9fa;
    padding: 15px;
    text-align: left;
    font-weight: 600;
    border-bottom: 1px solid #ddd;
    color: #333;
  }

  .logs-table td {
    padding: 12px 15px;
    border-bottom: 1px solid #eee;
    font-size: 14px;
  }

  .logs-table tr:hover {
    background: #f9f9f9;
  }

  .action-badge {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
  }

  .action-CREATE {
    background: #d4edda;
    color: #155724;
  }

  .action-UPDATE {
    background: #cce5ff;
    color: #0056b3;
  }

  .action-DELETE {
    background: #f8d7da;
    color: #721c24;
  }

  .action-LOGIN {
    background: #e2e3e5;
    color: #383d41;
  }

  .action-EXPORT {
    background: #fff3cd;
    color: #856404;
  }

  .action-IMPORT {
    background: #d1ecf1;
    color: #0c5460;
  }

  .action-BACKUP_CREATE {
    background: #d4e5f7;
    color: #004085;
  }

  .action-BACKUP_RESTORE {
    background: #f1c4d9;
    color: #721c24;
  }

  .timestamp {
    color: #666;
    font-size: 13px;
  }

  .pagination {
    display: flex;
    gap: 5px;
    justify-content: center;
    margin-top: 20px;
  }

  .pagination a,
  .pagination span {
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    text-decoration: none;
    color: black;
    cursor: pointer;
  }

  .pagination a:hover {
    background: #a83e51;
    color: white;
  }

  .pagination .active {
    background: #6a1b2a;
    color: white;
    border-color: #a83e51;
  }

  .pagination .disabled {
    color: #ccc;
    cursor: not-allowed;
  }

  .log-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
  }

  .stat-box {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    border-left: 4px solid #007bff;
  }

  .stat-label {
    color: #666;
    font-size: 13px;
  }

  .stat-value {
    font-size: 24px;
    font-weight: bold;
    color: #333;
    margin-top: 5px;
  }

  .export-btn {
    padding: 10px 20px;
    background: #28a745;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.3s;
  }

  .export-btn:hover {
    background: #218838;
  }

  .header-actions {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
  }

  @media (max-width: 768px) {
    .filters {
      flex-direction: column;
    }

    .filters input,
    .filters select {
      width: 100%;
    }

    .logs-table th,
    .logs-table td {
      padding: 10px;
      font-size: 12px;
    }

    .action-badge {
      font-size: 11px;
      padding: 3px 8px;
    }
  }
</style>
{% endblock %} {% block content %}

<div class="audit-container">
  <div class="audit-header">
    <h1> Audit Logs</h1>
    <p>Track all system activities and data modifications</p>
  </div>

  <!-- Statistics -->
  <div class="log-stats">
    <div class="stat-box">
      <div class="stat-label">Total Logs</div>
      <div class="stat-value">{{ total }}</div>
    </div>
    <div class="stat-box" style="border-left-color: #28a745">
      <div class="stat-label">Current Page</div>
      <div class="stat-value">{{ page }} / {{ total_pages }}</div>
    </div>
    <div class="stat-box" style="border-left-color: #17a2b8">
      <div class="stat-label">Logs Per Page</div>
      <div class="stat-value">50</div>
    </div>
  </div>

  <!-- Audit Logs Table -->
  <div class="logs-table">
    <table>
      <thead>
        <tr>
          <th>Timestamp</th>
          <th>User</th>
          <th>Action</th>
          <th>Table</th>
          <th>Record ID</th>
          <th>IP Address</th>
        </tr>
      </thead>
      <tbody>
        {% if logs %} {% for log in logs %}
        <tr>
          <td class="timestamp">{{ log['timestamp'] }}</td>
          <td><strong>{{ log['username'] }}</strong></td>
          <td>
            <span class="action-badge action-{{ log['action'] }}"
              >{{ log['action'] }}</span
            >
          </td>
          <td>
            <code
              style="
                font-size: 12px;
                background: #f5f5f5;
                padding: 2px 6px;
                border-radius: 3px;
              "
              >{{ log['table_name'] }}</code
            >
          </td>
          <td>{{ log['record_id'] or '-' }}</td>
          <td>
            <code style="font-size: 11px"
              >{{ log['ip_address'] or 'N/A' }}</code
            >
          </td>
        </tr>
        {% endfor %} {% else %}
        <tr>
          <td
            colspan="6"
            style="text-align: center; color: #999; padding: 40px"
          >
            No logs found
          </td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  {% if total_pages > 1 %}
  <div class="pagination">
    {% if page > 1 %}
    <a href="?page=1">First</a>
    <a href="?page={{ page - 1 }}">Previous</a>
    {% else %}
    <span class="disabled">First</span>
    <span class="disabled">Previous</span>
    {% endif %} {% for p in range(max(1, page - 2), min(total_pages + 1, page +
    3)) %} {% if p == page %}
    <span class="active">{{ p }}</span>
    {% else %}
    <a href="?page={{ p }}">{{ p }}</a>
    {% endif %} {% endfor %} {% if page < total_pages %}
    <a href="?page={{ page + 1 }}">Next</a>
    <a href="?page={{ total_pages }}">Last</a>
    {% else %}
    <span class="disabled">Next</span>
    <span class="disabled">Last</span>
    {% endif %}
  </div>
  {% endif %}
</div>

{% endblock %}
